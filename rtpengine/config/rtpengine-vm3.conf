# RTPEngine Configuration for VM3 (35.225.65.80)
# Optimized for production deployment

[rtpengine]
# Network interface configuration
# Using the public IP for media relay
interface = external/35.225.65.80!35.225.65.80

# Control protocol listeners (for Kamailio communication)
listen-ng = 0.0.0.0:22222
listen-tcp = 0.0.0.0:22222
listen-udp = 0.0.0.0:22222

# CLI interface for management
listen-cli = 127.0.0.1:22223

# RTP/RTCP port range
port-min = 30000
port-max = 40000

# Threading and performance
num-threads = 16
thread-stack = 2048

# Timeouts (in seconds)
timeout = 60
silent-timeout = 3600
final-timeout = 10800
offer-timeout = 3600

# Logging configuration
log-level = 6
log-stderr = false
log-facility = local5
log-file = /var/log/rtpengine/rtpengine.log

# Redis for distributed setup
redis = 10.0.0.100:6379
redis-db = 1
redis-expires = 86400
redis-allowed-errors = -1
redis-disable-time = 10

# Recording configuration
recording-dir = /var/spool/rtpengine/recordings
recording-method = proc
recording-format = wav

# Kernel forwarding
table = 0
no-fallback = false

# QoS marking
tos = 184

# Session limits
max-sessions = 10000
max-load = 0.8
max-cpu = 0.9
max-bandwidth = 1000000000

# DTLS/WebRTC support
dtls-passive = false
dtls-mtu = 1200

# ICE processing
ice-force = true
ice-force-relay = false
ice-lite = false
ice-tcp = false

# Codec configuration
transcode = G711,G722,opus
always-transcode = false

# Homer/HEP for monitoring
homer = 10.0.0.200:9060
homer-protocol = udp
homer-id = 1003

# Prometheus metrics
prometheus-endpoint = 0.0.0.0:9103

# SSL/TLS certificates
cert = /etc/rtpengine/cert.pem
key = /etc/rtpengine/key.pem

# NAT handling
symmetric-codecs = false
asymmetric-codecs = false
rtcp-mux-require = false
rtcp-mux-offer = true

# Media anchoring
force-relay = false

# SIP OPTIONS ping
sip-ping = true
sip-ping-interval = 30

# Jitter buffer
jitter-buffer = 50
jitter-buffer-delay = 100