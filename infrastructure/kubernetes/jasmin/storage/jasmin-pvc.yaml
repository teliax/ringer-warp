apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: jasmin-config-storage
  namespace: messaging
spec:
  accessModes:
    - ReadWriteMany  # ✅ Multiple pods can mount simultaneously
  storageClassName: jasmin-nfs
  resources:
    requests:
      storage: 10Gi
---
# Multi-Pod HA Architecture:
#
# Implementation: Multiple pods with NFS shared storage
# - ✅ ReadWriteMany PVC backed by NFS server (10.0.0.10)
# - ✅ All pods share /etc/jasmin/store/ for connector configs
# - ✅ Redis (db 1) provides runtime state (DLRs, sessions)
# - ✅ RabbitMQ provides message bus
# - ✅ Each pod maintains independent SMPP binds to Sinch
# - ✅ Cost: ~$15/month (e2-small VM + 10GB disk)
#
# NFS Server Details:
# - Host: 10.0.0.10 (warp-nfs-server)
# - Export: /exports/jasmin
# - Access: ReadWriteMany with NFSv4.1
